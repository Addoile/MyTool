<html>
<head>
<link rel="stylesheet" href="slickedit_api.css" type="text/css">
<title>_update_picture</title>
</head>
<body>

<h3><b>int _update_picture(int index, _str filename)</b></h3>
<P style="margin-top:0pt;margin-bottom:0pt;" class="JavadocDescription"><p>Replaces a picture or inserts a picture into the names table.
<i>filename</i> is the filename of a bitmap (<b>.bmp</b>) or pixmap
(<b>.xpm</b>) .    Currently only bitmaps and pixmap files are
supported.  After a picture is inserted into the names table, the path
information is removed (<b>name_name</b>(<b>p_picture</b>) has
no path).  Therefore, if you try to load two pictures from different
directories with the same name part into the names table, the second
copy will replace the first.</p><p>
<p>Important: Pictures are deleted from the names table when you save
the configuration if the name of the picture does not start with an
underscore ('_') and no forms reference the picture
(<b>p_picture</b>).</p><p>
<p>If <i>index</i> is less than 0, the existing picture will be replaced if it
already exists.  If it does not exist, the new picture is inserted.</p><p>
<p>If <i>index</i> is 0, a new picture is inserted.</p><p>
<p>If <i>index</i> is greater than 0, it is assumed to be a names table
index to an existing picture to be replaced.</p>
<P style="margin-bottom:0pt;" class="JavadocHeading"><B>Returns:</B> <B><code>int</code></b><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">Returns the names table index of the new picture if successful.  This
index can be used by the <b>p_picture</b> property.  On error, a
negative error code is returned.  Common error codes are
FILE_NOT_FOUND_RC are PATH_NOT_FOUND_RC.
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Example:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">
<pre>
// Replace the existing picture.  Use -1 for index unless you know
what you are doing.
index=_update_picture(-1, '_drfixed.ico');
messageNwait('name_name(index)='name_name(index));

// Try this code during a lbutton_up event of a command button.
// you need a form with a picture box called picture1 as well.
index=_update_picture(picture1.p_picture,'_drfixed.ico');
messageNwait('name_name(index)='name_name(index));
</pre>
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Category:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;"><a href="Names_Table_Functions.html">Names Table Functions</a></blockquote>
</body>
</html>
