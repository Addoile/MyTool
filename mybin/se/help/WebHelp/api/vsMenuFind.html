<html>
<head>
<link rel="stylesheet" href="slickedit_api.css" type="text/css">
<title>vsMenuFind</title>
</head>
<body>

<h3><b>int VSAPI vsMenuFind(int menu_handle, const char *pszCommand, int *pmenu_handle, int *pposition, char by_category)</b></h3>
<P style="margin-top:0pt;margin-bottom:0pt;" class="JavadocDescription">Finds menu or menu item with a specified command or category.
<P style="margin-bottom:0pt;" class="JavadocHeading"><B>Parameters:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="menu_handle">menu_handle</A></code> - Handle of loaded menu returned by
VSP_MENUHANDLE, vsMenuLoad,
vsMenuFind, or vsMenuGetState.
</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="pszCommand">pszCommand</A></code> - Command or category of menu item to
find.  If a command is specified, the
command must match exactly.  See
<i>by_category</i> parameter.
</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="pmenu_handle">pmenu_handle</A></code> - Handle to loaded menu which contains
menu item found.
</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="pposition">pposition</A></code> - Position of menu item found within
<i>pmenu_handle</i>.  0 is the position of
the first menu item.  Use the vsMenuQInfo
function to determine the number of items in
a loaded menu.
</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="by_category">by_category</A></code> - May be 'M' or  'C'.  If the 'M' option is given,
<i>pszCommand</i> is the command of the
menu item to be found.  If the 'C' option is
given,  <i>pszCommand</i> is the category
of the menu item to be found.  Defaults to
'C' if not specified.
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Returns:</B> <B><code>int</code></b><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">Returns 0 if successful.
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Example:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">
<pre>
void VSAPI dllproc ()
{
    int status;
    int mh,mp;
    // Find the menu item which executes the gui-find command
    status=vsMenuFind(
            vsPropGetI(VSWID_MDI,VSP_MENUHANDLE),
            "new", &mh, &mp,'M');
    if (status) {
        vsMessage("Command not found in menu bar");
        return;
    }
    int mf_flags;
    char caption[VSMAXMENUSTRING];
    char command[VSMAXMENUSTRING];
    char categories[VSMAXMENUSTRING];
    char  help_command[VSMAXMENUSTRING];
    char help_message[VSMAXMENUSTRING];
    vsMenuGetState(mh, mp, &mf_flags, 'P',
                                caption,VSMAXMENUSTRING
                                command, VSMAXMENUSTRING,
                                categories, VSMAXMENUSTRING,
                                help_command, VSMAXMENUSTRING,
                                help_message, VSMAXMENUSTRING );
    vsMessage(help_message);
}
</pre>
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Category:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;"><a href="Menu_Functions.html">Menu Functions</a></blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>See Also:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;"><a href="vsMenuDelete.html">vsMenuDelete</a>, <a href="vsMenuDestroy.html">vsMenuDestroy</a>, <a href="vsMenuFind.html">vsMenuFind</a>, <a href="vsMenuGetState.html">vsMenuGetState</a>, <a href="vsMenuInsert.html">vsMenuInsert</a>, <a href="vsMenuLoad.html">vsMenuLoad</a>, <a href="vsMenuQInfo.html">vsMenuQInfo</a>, <a href="vsMenuSet.html">vsMenuSet</a>, <a href="vsMenuSetState.html">vsMenuSetState</a>, <a href="vsMenuShow.html">vsMenuShow</a></blockquote>
</body>
</html>
