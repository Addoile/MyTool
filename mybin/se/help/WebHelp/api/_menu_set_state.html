<html>
<head>
<link rel="stylesheet" href="slickedit_api.css" type="text/css">
<title>_menu_set_state</title>
</head>
<body>

<h3><b>int _menu_set_state(int menu_handle, _str command_or_category, int mf_flags, _str option='C', _str item_text="", _str command="", _str category="", _str help_command="", _str help_message="")</b></h3>
<P style="margin-top:0pt;margin-bottom:0pt;" class="JavadocDescription">Sets menu item values for the menu items which contain the command or category specified.
<P style="margin-bottom:0pt;" class="JavadocHeading"><B>Parameters:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="menu_handle">menu_handle</A></code> - Handle of loaded menu returned by p_menu_handle, _menu_load, _menu_find, or _menu_get_state.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="command_or_category">command_or_category</A></code> - Command/category to look for or position of menu item within menu_handle.  If a command is specified, the command must match exactly.  See option parameter.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="mf_flags">mf_flags</A></code> - mf_flags may be zero or more of the following flags defined in "slick.sh":<pre>
      MF_CHECKED
      MF_UNCHECKED
      MF_GRAYED
      MF_ENABLED</pre></blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="option">option</A></code> - May be 'M', 'C', 'P'.  If the 'M' option is given, command_or_category is the command of the menu item to be found. If the 'C' option is given,  command_or_category is the category of the menu item to be found.  If the 'P' option is given, command_or_category is the position (0.._menu_info(menu_handle)-1) of the menu item with in menu_handle.  Defaults to 'C'.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="item_text">item_text</A></code> - Menu item text.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="command">command</A></code> - Menu item command to be executed.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="category">category</A></code> - Menu item category.  Another way to search for a menu item.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="help_command">help_command</A></code> - Menu item help command.  Executed when F1 pressed on menu item.</blockquote><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="text-indent:-13pt;margin-top:0pt;"><code><A NAME="help_message">help_message</A></code> - Menu item help message.  Display when cursor on menu item.
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Returns:</B> <B><code>int</code></b><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">Returns 0 if successful.
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Example:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;">
<pre>
   #include "slick.sh"
   // Create a form called form1 and set the border style to anything BUT
   // BDS_DIALOG BOX.  Windows does not allow forms with a dialog
   // box style border to have menu bars.
   defeventtab form1;
   form1.on_load()
   {
      // Find index of SlickEdit MDI menu resource
      index=find_index(def_mdi_menu,oi2type(OI_MENU));
      // Load this menu resource
      menu_handle=p_active_form._menu_load(index);
      // _set_menu will fail if the form has a dialog box style border.

      // Put a menu bar on this form.
      _menu_set(menu_handle);

      // You DO NOT need to call _menu_destroy.  This menu is destroyed when the form
      // window is deleted.
      // Gray out all menu items which are not allowed when there no child windows.
      _menu_set_state(menu_handle,"new",MF_GRAYED,'M');
   }
</pre>
</blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>Category:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;"><a href="Menu_Functions.html">Menu Functions</a></blockquote><P style="margin-bottom:0pt;" class="JavadocHeading"><B>See Also:</B><blockquote style="margin-top:0pt;margin-bottom:0pt;"><p style="margin-top:0pt;margin-left:-13pt;"><a href="on_init_menu.html">on_init_menu</a>, <a href="_menu_add_filehist.html">_menu_add_filehist</a>, <a href="_menu_add_hist.html">_menu_add_hist</a>, <a href="_menu_add_workspace_hist.html">_menu_add_workspace_hist</a>, <a href="_menu_delete.html">_menu_delete</a>, <a href="_menu_destroy.html">_menu_destroy</a>, <a href="_menu_find.html">_menu_find</a>, <a href="_menu_get_state.html">_menu_get_state</a>, <a href="_menu_info.html">_menu_info</a>, <a href="_menu_insert.html">_menu_insert</a>, <a href="_menu_load.html">_menu_load</a>, <a href="_menu_match.html">_menu_match</a>, <a href="_menu_move.html">_menu_move</a>, <a href="_menu_set.html">_menu_set</a>, <a href="_menu_show.html">_menu_show</a>, <a href="alt_menu.html">alt_menu</a>, <a href="insert_object.html">insert_object</a>, <a href="menu_mdi_bind_all.html">menu_mdi_bind_all</a>, <a href="mou_show_menu.html">mou_show_menu</a>, <a href="show.html">show</a></blockquote>
</body>
</html>
